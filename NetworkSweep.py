#!/usr/bin/python
# -*- coding: utf-8 -*-

#Sergio Iván Galindo Díaz
#Programa Network Sweep
#Curso: Pentest
import os
import sys
import platform
from datetime import datetime

if len(sys.argv) != 4:
    print ("Debes ejecutar NetworkSweep.py <ip> <HostStart> <HostEnd>")

IP = sys.argv[1]
Start = int(sys.argv[2])
End = int(sys.argv[3])
IpSplit = IP.split('.')
 
try:
    Network = IpSplit[0]+'.'+IpSplit[1]+'.'+IpSplit[2]+'.'
except:
    print "Error Fatal-> Formato inválido"
    sys.exit(1)

TimeStart = datetime.now()
print "Escaneando desde-> ",Network+str(Start),"hasta",Network+str(End)
for subNetwork in range(Start, End+1):
    Address = Network+str(subNetwork)
    Response = os.popen("hping3 -1 -c 2 "+ Address + " 2> /dev/null")
    for line in Response.readlines():
        if ("ttl" in line.lower()):
            print Address,"esta activo"
            break

            
TimeEnd = datetime.now()
TimeLapse = TimeEnd - TimeStart
print "Duración del escaneo -> %s"%TimeLapse