#!/usr/bin/python
# -*- coding: utf-8 -*-

#Sergio Iván Galindo Díaz
#Programa que obtiene el S.O a partir de las ttl
#Curso : Pentest

import sys, commands

if len(sys.argv)!=2:
	print("Debes ejecutar ttl.py <ip>")
#Solo funciona en linux, falta adecuarlo para otros S.O
else:
	ttl = commands.getoutput("\nping -c1 " + sys.argv[1] + "| grep \"ttl\" | cut -d \" \" -f6")

	if (ttl == 'ttl=64'):
		print("Tu Sistema operativo es un linux")
	if (ttl == 'ttl=128'):
		print("Tu Sistema operativo es un Windows")
	if (ttl == 'ttl=255'):
		print("Tu Sistema operativo es un Solaris")
	